<app-error-message-bar
    *ngIf="!sceneId"
    message="Scene does not exist"
    (back)="back()"
></app-error-message-bar>

<div *ngIf="sceneId" class="action-create-wrapper">
    <div style="display: flex; width: 100%">
        <p class="page-title">{{ 'scene.createAction' | translate }}</p>
        <div style="margin-left: auto">
            <button mat-button (click)="back()" color="primary">
                {{ 'scene.back' | translate }}
            </button>
        </div>
    </div>
    <form [formGroup]="roomDeviceGroup">
        <h3>{{ 'scene.selectDevice' | translate }}</h3>
        <div>
            <mat-form-field appearance="fill">
                <mat-label>{{ 'scene.room' | translate }}</mat-label>
                <mat-select required formControlName="room">
                    <mat-option
                        *ngFor="let room of room$ | async"
                        [value]="room"
                    >
                        {{ room }}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>
        <div>
            <mat-form-field appearance="fill">
                <mat-label>{{ 'scene.device' | translate }}</mat-label>
                <mat-select required formControlName="device">
                    <mat-option
                        *ngFor="let load of load$ | async"
                        [value]="load"
                    >
                        {{ load.name }} ({{ load.type.toString() | uppercase }})
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>
    </form>
    <div *ngIf="roomDeviceGroup.value.device">
        <h3>
            {{ 'scene.selectAction' | translate }}
        </h3>
        <h3>{{ selectedLoad.name }} ({{ roomDeviceGroup.value.room }})</h3>
        <ng-container [ngSwitch]="selectedLoad.type">
            <ng-container *ngSwitchCase="'dimmer'">
                <app-dimmer-action-form
                    [sceneId]="sceneId"
                    [sceneName]="sceneName"
                    [device]="selectedLoad"
                ></app-dimmer-action-form>
            </ng-container>
            <ng-container *ngSwitchCase="'switch'">
                <app-switch-action-form
                    [sceneId]="sceneId"
                    [sceneName]="sceneName"
                    [device]="selectedLoad"
                ></app-switch-action-form>
            </ng-container>
            <ng-container *ngSwitchCase="'motor'">
                <app-motor-action-form
                    [sceneId]="sceneId"
                    [sceneName]="sceneName"
                    [device]="selectedLoad"
                ></app-motor-action-form>
            </ng-container>
        </ng-container>
    </div>
</div>
